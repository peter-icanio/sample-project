name: "python-deploy"
on: 
  push:
    branches:
       - main

jobs:
   PYTHON_DEPLOY:
    runs-on: self-hosted
    name: login to server
    steps:      
      - name: Checkout code
        uses: actions/checkout@v3
      - name: Notify on push
        run: |
          pwd
          cd /home/ubuntu/actions-runner/_work/sample-project/sample-project
          ls
          pm2 delete python-deploy
          pm2 start "python3 app.py" --name python-deploy
           - name: Send  message to google chat
          env:
          GOOGLE_Chat: ${{ secrets.GOOGLE_CHAT_WEBHOOK }}
          run: |
          echo "peter"
          curl -X POST -H 'Content-Type: application/json' -d '{"text": "Code was pushed to the repository."}' $GOOGLE_CHAT_WEBHOOK

        
